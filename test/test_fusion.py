#!/usr/bin/env python3

__author__ = 'Frederic Escudie'
__copyright__ = 'Copyright (C) 2020 IUCT-O'
__license__ = 'GNU General Public License'
__version__ = '1.1.1'
__email__ = 'escudie.frederic@iuct-oncopole.fr'
__status__ = 'prod'

import os
import sys
import uuid
import tempfile
import unittest

TEST_DIR = os.path.dirname(os.path.abspath(__file__))
PACKAGE_DIR = os.path.dirname(TEST_DIR)
sys.path.append(PACKAGE_DIR)

from anacore.vcf import VCFRecord
from anacore.fusion import *


####################################################################
#
# FUNCTIONS
#
####################################################################
class FusionFileReaderTest(unittest.TestCase):
    def setUp(self):
        tmp_folder = tempfile.gettempdir()
        unique_id = str(uuid.uuid1())
        self.tmp_in = os.path.join(tmp_folder, unique_id + "_fusions.tsv")
        self.test_cases = [
            {
                "expected": FusionCatcherIO,
                "content": 'Gene_1_symbol(5end_fusion_partner)	Gene_2_symbol(3end_fusion_partner)	Fusion_description	Counts_of_common_mapping_reads	Spanning_pairs	Spanning_unique_reads	Longest_anchor_found	Fusion_finding_method	Fusion_point_for_gene_1(5end_fusion_partner)	Fusion_point_for_gene_2(3end_fusion_partner)	Gene_1_id(5end_fusion_partner)	Gene_2_id(3end_fusion_partner)	Exon_1_id(5end_fusion_partner)	Exon_2_id(3end_fusion_partner)	Fusion_sequence	Predicted_effect'
            },
            {
                "expected": FusionCatcherIO,
                "content": 'Gene_1_symbol(5end_fusion_partner)	Gene_2_symbol(3end_fusion_partner)	Fusion_description	Counts_of_common_mapping_reads	Spanning_pairs	Spanning_unique_reads	Longest_anchor_found	Fusion_finding_method	Fusion_point_for_gene_1(5end_fusion_partner)	Fusion_point_for_gene_2(3end_fusion_partner)	Gene_1_id(5end_fusion_partner)	Gene_2_id(3end_fusion_partner)	Exon_1_id(5end_fusion_partner)	Exon_2_id(3end_fusion_partner)	Fusion_sequence'
            },
            {
                "expected": STARFusionIO,
                "content": '#FusionName	JunctionReadCount	SpanningFragCount	SpliceType	LeftGene	LeftBreakpoint	RightGene	RightBreakpoint	JunctionReads	SpanningFrags	LargeAnchorSupport	FFPM	LeftBreakDinuc	LeftBreakEntropy	RightBreakDinuc	RightBreakEntropy	annots'
            },
            {
                "expected": STARFusionIO,
                "content": '#FusionName	JunctionReadCount	SpanningFragCount	SpliceType	LeftGene	LeftBreakpoint	RightGene	RightBreakpoint	LargeAnchorSupport	FFPM	LeftBreakDinuc	LeftBreakEntropy	RightBreakDinuc	RightBreakEntropy	annots'
            },
            {
                "expected": ArribaIO,
                "content": '#gene1	gene2	strand1(gene/fusion)	strand2(gene/fusion)	breakpoint1	breakpoint2	site1	site2	type	direction1	direction2	split_reads1	split_reads2	discordant_mates	coverage1	coverage2	confidence	closest_genomic_breakpoint1	closest_genomic_breakpoint2	filters	fusion_transcript	reading_frame	peptide_sequence	read_identifiers'
            }
        ]
        self.test_exceptions = [
            "",
            'Gene	Count',
            'ATGCATTGGCAT'
        ]

    def tearDown(self):
        # Clean temporary files
        if os.path.exists(self.tmp_in):
            os.remove(self.tmp_in)

    def test_factory(self):
        for curr_test in self.test_cases:
            with open(self.tmp_in, "w") as writer:
                writer.write(curr_test["content"])
            self.assertEqual(
                curr_test["expected"],
                FusionFileReader.factory(self.tmp_in).__class__
            )

    def test_factoryExceptions(self):
        for curr_content in self.test_exceptions:
            with open(self.tmp_in, "w") as writer:
                writer.write(curr_content)
            with self.assertRaises(IOError) as context:
                FusionFileReader.factory(self.tmp_in)

    def test_factoryParams(self):
        for curr_test in self.test_cases:
            with open(self.tmp_in, "w") as writer:
                writer.write(curr_test["content"])
            with FusionFileReader.factory(self.tmp_in, "r", "splA", annot_field="AnnotField") as reader:
                self.assertEqual(
                    curr_test["expected"],
                    reader.__class__
                )
                self.assertEqual(
                    "splA",
                    reader.sample_name
                )
                self.assertEqual(
                    "AnnotField",
                    reader.annot_field
                )


class FusionCatcherIOTest(unittest.TestCase):
    def setUp(self):
        tmp_folder = tempfile.gettempdir()
        unique_id = str(uuid.uuid1())
        # Temporary files
        self.tmp_in_tsv = os.path.join(tmp_folder, unique_id + "_in.tsv")
        self.tmp_out_tsv = os.path.join(tmp_folder, unique_id + "_out.tsv")
        # Create in TSV
        content = '''Gene_1_symbol(5end_fusion_partner)	Gene_2_symbol(3end_fusion_partner)	Fusion_description	Counts_of_common_mapping_reads	Spanning_pairs	Spanning_unique_reads	Longest_anchor_found	Fusion_finding_method	Fusion_point_for_gene_1(5end_fusion_partner)	Fusion_point_for_gene_2(3end_fusion_partner)	Gene_1_id(5end_fusion_partner)	Gene_2_id(3end_fusion_partner)	Exon_1_id(5end_fusion_partner)	Exon_2_id(3end_fusion_partner)	Fusion_sequence	Predicted_effect
RREB1	MKL2	oncogene,cancer,exon-exon	0	9	10	30	BOWTIE	6:7211709:+	16:14245528:+	ENSG00000124782	ENSG00000186260	ENSE00003408308	ENSE00001202958	GACTGGAGACCCACATGGAGACCCATTCAGATAACCCACTAAG*GCCACTCAATGACAAAAATAGTAACAGTGGGAATTCAGCTTTG	in-frame'''
        with open(self.tmp_in_tsv, "w") as writer:
            writer.write(content)

    def tearDown(self):
        # Clean temporary files
        for curr_file in [self.tmp_in_tsv, self.tmp_out_tsv]:
            if os.path.exists(curr_file):
                os.remove(curr_file)

    def test_ReadWrite(self):
        # Read, convert to VCF, covert to dict and write
        with FusionCatcherIO(self.tmp_out_tsv, "w") as writer:
            with FusionCatcherIO(self.tmp_in_tsv) as reader:
                for first_bnd, second_bnd in reader:
                    writer.write((first_bnd, second_bnd))
        # Eval
        expected = None
        with open(self.tmp_out_tsv) as expec_reader:
            expected = expec_reader.readlines()
        observed = None
        with open(self.tmp_out_tsv) as obs_reader:
            observed = obs_reader.readlines()
        self.assertEqual(expected, observed)


class STARFusionIOTest(unittest.TestCase):
    def setUp(self):
        tmp_folder = tempfile.gettempdir()
        unique_id = str(uuid.uuid1())
        # Temporary files
        self.tmp_in = os.path.join(tmp_folder, unique_id + "_in.tsv")
        self.tmp_in_abridged = os.path.join(tmp_folder, unique_id + "_in_abridged.tsv")
        self.tmp_out = os.path.join(tmp_folder, unique_id + "_out.tsv")
        # Create in TSV
        content = '''#FusionName	JunctionReadCount	SpanningFragCount	SpliceType	LeftGene	LeftBreakpoint	RightGene	RightBreakpoint	JunctionReads	SpanningFrags	LargeAnchorSupport	FFPM	LeftBreakDinuc	LeftBreakEntropy	RightBreakDinuc	RightBreakEntropy	annots
MN1--BEND2	90	39	ONLY_REF_SPLICE	MN1^ENSG00000169184.6	chr22:27796763:-	BEND2^ENSG00000177324.14	chrX:18195442:-	M70265:74:000000000-B4F4J:1:2116:12294:7575,M70265:74:000000000-B4F4J:1:2115:7184:4292,M70265:74:000000000-B4F4J:1:1104:5050:21345,M70265:74:000000000-B4F4J:1:1119:9539:18627,M70265:74:000000000-B4F4J:1:2115:8678:9709,M70265:74:000000000-B4F4J:1:2119:19014:22293,M70265:74:000000000-B4F4J:1:2105:16442:9076,M70265:74:000000000-B4F4J:1:1117:12801:7721,M70265:74:000000000-B4F4J:1:1111:14401:18304,M70265:74:000000000-B4F4J:1:1112:22240:14651,M70265:74:000000000-B4F4J:1:1108:20469:22260,M70265:74:000000000-B4F4J:1:2102:11105:8918,M70265:74:000000000-B4F4J:1:2108:19409:16466,M70265:74:000000000-B4F4J:1:1113:20196:5091,M70265:74:000000000-B4F4J:1:1105:10766:13643,M70265:74:000000000-B4F4J:1:1103:19101:13070,M70265:74:000000000-B4F4J:1:2107:24460:10546,M70265:74:000000000-B4F4J:1:1106:19866:14418,M70265:74:000000000-B4F4J:1:1106:5053:13766,M70265:74:000000000-B4F4J:1:2113:20643:17000,M70265:74:000000000-B4F4J:1:2102:25631:11285,M70265:74:000000000-B4F4J:1:1119:27699:19981,M70265:74:000000000-B4F4J:1:2113:4962:18403,M70265:74:000000000-B4F4J:1:2106:25372:20356,M70265:74:000000000-B4F4J:1:2108:16489:16372,M70265:74:000000000-B4F4J:1:1105:14999:8683,M70265:74:000000000-B4F4J:1:1107:13181:5229,M70265:74:000000000-B4F4J:1:1103:9694:18262,M70265:74:000000000-B4F4J:1:1106:7893:19397,M70265:74:000000000-B4F4J:1:1119:28664:16235,M70265:74:000000000-B4F4J:1:1119:25900:13031,M70265:74:000000000-B4F4J:1:2117:5341:12350,M70265:74:000000000-B4F4J:1:2108:21016:10605,M70265:74:000000000-B4F4J:1:1111:6184:20952,M70265:74:000000000-B4F4J:1:1111:7115:5525,M70265:74:000000000-B4F4J:1:1110:27378:16651,M70265:74:000000000-B4F4J:1:1108:14118:21000,M70265:74:000000000-B4F4J:1:2110:8046:7787,M70265:74:000000000-B4F4J:1:2112:29162:12358,M70265:74:000000000-B4F4J:1:1114:12762:7330,M70265:74:000000000-B4F4J:1:1112:6478:12309,M70265:74:000000000-B4F4J:1:2114:8353:4989,M70265:74:000000000-B4F4J:1:1110:12165:19870,M70265:74:000000000-B4F4J:1:2119:26398:14585,M70265:74:000000000-B4F4J:1:1104:19297:14091,M70265:74:000000000-B4F4J:1:1114:12488:10493,M70265:74:000000000-B4F4J:1:2110:19477:14905,M70265:74:000000000-B4F4J:1:1111:29396:14060,M70265:74:000000000-B4F4J:1:1112:5997:8955,M70265:74:000000000-B4F4J:1:1114:21233:24893,M70265:74:000000000-B4F4J:1:1117:16546:12881,M70265:74:000000000-B4F4J:1:2102:15683:16355,M70265:74:000000000-B4F4J:1:1102:7568:7922,M70265:74:000000000-B4F4J:1:1104:24497:10850,M70265:74:000000000-B4F4J:1:1112:12330:15917,M70265:74:000000000-B4F4J:1:2104:23488:20289,M70265:74:000000000-B4F4J:1:2115:18539:5639,M70265:74:000000000-B4F4J:1:2108:27004:11103,M70265:74:000000000-B4F4J:1:1108:7280:6580,M70265:74:000000000-B4F4J:1:1111:13093:9434,M70265:74:000000000-B4F4J:1:1105:22026:13215,M70265:74:000000000-B4F4J:1:1103:12233:24724,M70265:74:000000000-B4F4J:1:1114:21833:4508,M70265:74:000000000-B4F4J:1:1102:5182:21387,M70265:74:000000000-B4F4J:1:2102:20234:8226,M70265:74:000000000-B4F4J:1:1104:5911:7048,M70265:74:000000000-B4F4J:1:1104:19911:7039,M70265:74:000000000-B4F4J:1:2101:23116:15940,M70265:74:000000000-B4F4J:1:1102:28272:19048,M70265:74:000000000-B4F4J:1:2107:3513:10128,M70265:74:000000000-B4F4J:1:2101:3654:8461,M70265:74:000000000-B4F4J:1:1119:19110:18013,M70265:74:000000000-B4F4J:1:1107:18400:1636,M70265:74:000000000-B4F4J:1:2115:15123:16288,M70265:74:000000000-B4F4J:1:2110:13483:19384,M70265:74:000000000-B4F4J:1:2101:9347:11364,M70265:74:000000000-B4F4J:1:1103:14624:5192,M70265:74:000000000-B4F4J:1:2103:25588:18903,M70265:74:000000000-B4F4J:1:1117:15805:5600,M70265:74:000000000-B4F4J:1:1119:13495:19891,M70265:74:000000000-B4F4J:1:1108:7984:5492,M70265:74:000000000-B4F4J:1:1117:9253:13094,M70265:74:000000000-B4F4J:1:1112:8428:11232,M70265:74:000000000-B4F4J:1:2103:22447:6340,M70265:74:000000000-B4F4J:1:1111:26219:5015,M70265:74:000000000-B4F4J:1:1112:14939:4411,M70265:74:000000000-B4F4J:1:2109:18888:3219,M70265:74:000000000-B4F4J:1:2110:22338:16190,M70265:74:000000000-B4F4J:1:2114:11325:2713,M70265:74:000000000-B4F4J:1:2114:6567:13905	M70265:74:000000000-B4F4J:1:1111:7154:15877,M70265:74:000000000-B4F4J:1:2117:22762:16468,M70265:74:000000000-B4F4J:1:1112:3545:11649,M70265:74:000000000-B4F4J:1:1102:13385:24356,M70265:74:000000000-B4F4J:1:1103:21865:16107,M70265:74:000000000-B4F4J:1:2109:19125:3230,M70265:74:000000000-B4F4J:1:1113:11062:16439,M70265:74:000000000-B4F4J:1:2115:11207:19666,M70265:74:000000000-B4F4J:1:2102:1922:14639,M70265:74:000000000-B4F4J:1:2105:29283:14469,M70265:74:000000000-B4F4J:1:1109:15243:9627,M70265:74:000000000-B4F4J:1:1108:22583:13263,M70265:74:000000000-B4F4J:1:1103:23453:4405,M70265:74:000000000-B4F4J:1:1113:9694:20456,M70265:74:000000000-B4F4J:1:2103:19632:8012,M70265:74:000000000-B4F4J:1:1102:18799:15205,M70265:74:000000000-B4F4J:1:1102:19075:11592,M70265:74:000000000-B4F4J:1:2114:28568:18618,M70265:74:000000000-B4F4J:1:1112:21951:11679,M70265:74:000000000-B4F4J:1:1111:22886:13062,M70265:74:000000000-B4F4J:1:1115:17822:21329,M70265:74:000000000-B4F4J:1:1116:21890:11280,M70265:74:000000000-B4F4J:1:1104:10237:9204,M70265:74:000000000-B4F4J:1:1112:3494:8607,M70265:74:000000000-B4F4J:1:2103:5353:4657,M70265:74:000000000-B4F4J:1:2101:18273:12696,M70265:74:000000000-B4F4J:1:2109:13674:17280,M70265:74:000000000-B4F4J:1:1103:18734:3105,M70265:74:000000000-B4F4J:1:2102:17275:5848,M70265:74:000000000-B4F4J:1:1112:24048:22285,M70265:74:000000000-B4F4J:1:1115:21982:9046,M70265:74:000000000-B4F4J:1:1109:27605:16863,M70265:74:000000000-B4F4J:1:1111:14542:18181,M70265:74:000000000-B4F4J:1:1104:9119:13899,M70265:74:000000000-B4F4J:1:1114:10485:22262,M70265:74:000000000-B4F4J:1:2111:24444:4566,M70265:74:000000000-B4F4J:1:2113:24284:23644,M70265:74:000000000-B4F4J:1:2104:27141:8778,M70265:74:000000000-B4F4J:1:2117:13953:8079	YES_LDAS	38.9246	GT	1.4566	AG	1.7968	["HaasMedCancer","INTERCHROMOSOMAL[chr22--chrX]"]
SPECC1L-ADORA2A--NTRK2	22	6	ONLY_REF_SPLICE	SPECC1L-ADORA2A^ENSG00000258555.6	chr22:24334573:+	NTRK2^ENSG00000148053.16	chr9:84867243:+	M70265:74:000000000-B4F4J:1:1102:11424:4669,M70265:74:000000000-B4F4J:1:1104:6405:2923,M70265:74:000000000-B4F4J:1:1114:21462:20506,M70265:74:000000000-B4F4J:1:1108:9784:2773,M70265:74:000000000-B4F4J:1:2119:22961:20082,M70265:74:000000000-B4F4J:1:2116:27522:11441,M70265:74:000000000-B4F4J:1:1108:23971:7984,M70265:74:000000000-B4F4J:1:1113:23518:22366,M70265:74:000000000-B4F4J:1:1115:7837:20035,M70265:74:000000000-B4F4J:1:2104:21327:2495,M70265:74:000000000-B4F4J:1:1101:9462:22886,M70265:74:000000000-B4F4J:1:1108:5888:7340,M70265:74:000000000-B4F4J:1:2103:6756:2599,M70265:74:000000000-B4F4J:1:1114:10446:14926,M70265:74:000000000-B4F4J:1:1108:4192:20832,M70265:74:000000000-B4F4J:1:2110:22090:10259,M70265:74:000000000-B4F4J:1:1107:22426:22529,M70265:74:000000000-B4F4J:1:1102:20172:13788,M70265:74:000000000-B4F4J:1:1102:14526:14874,M70265:74:000000000-B4F4J:1:1108:28140:12698,M70265:74:000000000-B4F4J:1:1109:25864:11274,M70265:74:000000000-B4F4J:1:1109:21996:25012	M70265:74:000000000-B4F4J:1:1108:25374:7116,M70265:74:000000000-B4F4J:1:1102:12684:14754,M70265:74:000000000-B4F4J:1:1102:12917:5068,M70265:74:000000000-B4F4J:1:1101:28832:12042,M70265:74:000000000-B4F4J:1:1101:26215:18199,M70265:74:000000000-B4F4J:1:2110:18851:11245	YES_LDAS	8.3732	GT	1.9656	AG	1.8295	["INTERCHROMOSOMAL[chr22--chr9]"]
SPECC1L-ADORA2A--NTRK2	3	6	ONLY_REF_SPLICE	SPECC1L-ADORA2A^ENSG00000258555.6	chr22:24334573:+	NTRK2^ENSG00000148053.16	chr9:84861040:+	M70265:74:000000000-B4F4J:1:1108:15540:9098,M70265:74:000000000-B4F4J:1:2104:21069:2777,M70265:74:000000000-B4F4J:1:1116:20816:4555	M70265:74:000000000-B4F4J:1:1101:28832:12042,M70265:74:000000000-B4F4J:1:1102:12917:5068,M70265:74:000000000-B4F4J:1:1101:26215:18199,M70265:74:000000000-B4F4J:1:1108:25374:7116,M70265:74:000000000-B4F4J:1:1102:12684:14754,M70265:74:000000000-B4F4J:1:2110:18851:11245	YES_LDAS	2.6914	GT	1.9656	AG	1.7232	["INTERCHROMOSOMAL[chr22--chr9]"]'''
        with open(self.tmp_in, "w") as writer:
            writer.write(content)
        with open(self.tmp_in_abridged, "w") as writer:
            for line in content.split("\n"):
                fields = line.split("\t")
                abridged_line = "\t".join(fields[:8] + fields[10:])
                writer.write(abridged_line + "\n")

    def tearDown(self):
        # Clean temporary files
        for curr_file in [self.tmp_in, self.tmp_in_abridged, self.tmp_out]:
            if os.path.exists(curr_file):
                os.remove(curr_file)

    def test_ReadWrite(self):
        # Read, convert to VCF, convert to dict and write
        with STARFusionIO(self.tmp_out, "w") as writer:
            with STARFusionIO(self.tmp_in) as reader:
                for first_bnd, second_bnd in reader:
                    writer.write((first_bnd, second_bnd))
        # Eval
        expected = None
        with open(self.tmp_out) as expec_reader:
            expected = expec_reader.readlines()
        observed = None
        with open(self.tmp_out) as obs_reader:
            observed = obs_reader.readlines()
        self.assertEqual(expected, observed)

    def test_ReadWriteAbridged(self):
        # Read, convert to VCF, convert to dict and write
        with STARFusionIO(self.tmp_out, "w") as writer:
            with STARFusionIO(self.tmp_in_abridged) as reader:
                for first_bnd, second_bnd in reader:
                    writer.write((first_bnd, second_bnd))
        # Eval
        expected = None
        with open(self.tmp_out) as expec_reader:
            expected = []
            for idx, line in enumerate(expec_reader.readlines()):
                if idx != 0:
                    fields = line.split("\t")
                    fields[8] = ""
                    fields[9] = ""
                    line = "\t".join(fields)
                expected.append(line)
        observed = None
        with open(self.tmp_out) as obs_reader:
            observed = obs_reader.readlines()
        self.assertEqual(expected, observed)


class ArribaIOTest(unittest.TestCase):
    def setUp(self):
        tmp_folder = tempfile.gettempdir()
        unique_id = str(uuid.uuid1())
        # Temporary files
        self.tmp_in_tsv = os.path.join(tmp_folder, unique_id + "_in.tsv")
        self.tmp_out_tsv = os.path.join(tmp_folder, unique_id + "_out.tsv")
        # Create in TSV
        content = """#gene1	gene2	strand1(gene/fusion)	strand2(gene/fusion)	breakpoint1	breakpoint2	site1	site2	type	direction1	direction2	split_reads1	split_reads2	discordant_mates	coverage1	coverage2	confidence	closest_genomic_breakpoint1	closest_genomic_breakpoint2	filters	fusion_transcript	reading_frame	peptide_sequence	read_identifiers
BCR	ABL1	+/+	+/+	22:23289621	9:130854064	splice-site	splice-site	translocation	downstream	upstream	12	165	84	386	1134	high	.	.	duplicates(63)	CGGAGAGGCTGAAGAAGAAGCTGTCGGAGCAGGAGTCACTGCTGCTGCTTATGTCTCCCAGCATGGCCTTCAGGGTGCACAGCCGCAACGGCAAG___AGTTACACGTTCCTGATCTCCTCTGACTATGAGCGTGCAGAGTGGAGGGAGAACATCCGGGAGCAGCAGAAGAAGT___GTTTCAGAAGCTTCTCCCTGACATCCGTGGAGCTGCAGATGCTGACCAACTCGTGTGTGAAACTCCAGACTGTCCACAGCATTCCGCTGACCATCAAcAAGGAAG|AAGCCCTTCAGCGGCCAGTAGCATCTGACTTTGAGCCTCAGGGTCTGAGTGAAGCCGCTCGTTGGAACTCCAAGGAAAACCTTCTCGCTGGACCCAGTGAAAATGACCCCAACCTTTTCGTTGCACTGTATGATTTTGTGGCCAGTGGAGATAACACTCTAAGCATAACTAAAG___GTGAAAAGCTCCGGGTCTTAGGCTATAATCACAATGGGGAATGGTGTGAAGCCCAAACCAAAAATGGCCAAGGCTGGGTCCCAAGCAACTACATCACGCCAGTCAACAGTCTGGAGAAACACTCCTGGTACCATGGGCCTGTGTCCCGCAATGCCGCTGAGTATCTGCTGAGCAGCGGGATCAATGGCAGCTTCTTGGTGCGTGAGAGTGAGAG	in-frame	ERLKKKLSEQESLLLLMSPSMAFRVHSRNGKSYTFLISSDYERAEWRENIREQQKKCFRSFSLTSVELQMLTNSCVKLQTVHSIPLTINKE|eALQRPVASDFEPQGLSEAARWNSKENLLAGPSENDPNLFVALYDFVASGDNTLSITKGEKLRVLGYNHNGEWCEAQTKNGQGWVPSNYITPVNSLEKHSWYHGPVSRNAAEYLLSSGINGSFLVRESE	.
ABL1	BCR	+/+	+/+	9:130714455	22:23292541	splice-site	splice-site	translocation	downstream	upstream	9	9	1	188	433	high	.	.	duplicates(1)	GAAACTTTTGGGTAACATTGCAATTACATGAAATTGATAACCGCGAAAATAATTGGAACTCCTGCTTGCAAGTGTCAACCTAAAAAAAGTGCTTCCTTTTGTTATGGAAGATGTCTTTCTGTGATTGACTTCAATTGCTGACTTGTGGAGATGCAGCGAATGTGAAATCCCACGTATATGCCATTTCCCTCTACGCTCGCTGACCGTTCTGGAAGATCTTGAACCCTCTTCTGGAAAGGGGTACCTATTATTACTTTATGGGGCAGCAGCCTGGAAAAGTACTTGGGGACCAAAGAAGGCCAAGCTTGCCTGCCCTGCATTTTATCAAAGGAGCAGGGAAGAAGGAATCATCGAGGCATGGGGGTCCACACTGCAATGTTTTTGTGGAACATG|ATCTGTACTGCACCCTGGAGGTGGATTCCTTTGGGTATTTTGTGAATAAAGCAAAGACGCGCGTCTACAGGGACACAGCTGAGCCAAACTGGAACGAG___GAATTTGAGATAGAGCTGGAGGGCTCCCAGACCCTGAGGATACTGTGCTATGAAAAGTGTTACAACAAGACGAAGATCCCCAAGGAGGACGGCGAGAGCACGG...___CTGGACCCGCAGGCCCTGCAGGACAGAGACTGGCAGCGCACCGTCATCGCCATGAATGGG	in-frame	MGQQPGKVLGDQRRPSLPALHFIKGAGKKESSRHGGPHCNVFVEH|dLYCTLEVDSFGYFVNKAKTRVYRDTAEPNWNEEFEIELEGSQTLRILCYEKCYNKTKIPKEDGEST	.
ABL1	BCR	+/+	+/+	9:130835525	22:23290339	splice-site	splice-site	translocation	downstream	upstream	1	4	1	27	328	high	.	.	.	CGGGCCTGAGCCGGGCCCGCGGACCGAGCTtGGAGAGGGGcTCCGGCCCCCGACGTGCTGGCGCGGGAAAATGTTGGAGATCTGCCTGAAGCTGGTGGGCTGCAAATCCAAGAAGGGGCTGTCCTCGTCCTCCAGCTGTTATCTGGAAG|ATGATGAGTCTCCGGGGCTCTATGGGTTTCTGAATGTCATCGTCCACTCAGCCACTGGATTTAAGCAGAGTTCAA___ATCTGTACTGCACCCTGGAGGTGGATTCCTTTGGGTATTTTGTGAATAAAGCAAAGACGCGCGTCTACAGGGACACAGCTGAGCCAAACTGGAACGAG___GAATTTGAGATAGAGCTGGAGGGCTCCCAGACCCTGAGGATACTGTGCTATGAAAAGTGTTACAACAAGA	in-frame	MLEICLKLVGCKSKKGLSSSSSCYLE|dDESPGLYGFLNVIVHSATGFKQSSNLYCTLEVDSFGYFVNKAKTRVYRDTAEPNWNEEFEIELEGSQTLRILCYEKCYNK	.
ABL1	BCR	+/+	+/+	9:130714455	22:23290339	splice-site	splice-site	translocation	downstream	upstream	0	4	1	188	328	high	.	.	.	CCGTTCTGGAAGATCTTGAACCCTCTTCTGGAAAGGGGTACCTATTATTACTTTATGGGGCAGCAGCCTGGAAAAGTACTTGGGGACCAAAGAAGGCCAAGCTTGCCTGCCCTGCATTTTATCAAAGGAGCAGGGAAGAAGGAATCATCGAGGCATGGGGGTCCACACTGCAATGTTTTTGTGGAACATG|ATGATGAGTCTCCGGGGCTCTATGGGTTTCTGAATGTCATCGTCCACTCAGCCACTGGATTTAAGCAGAGTTCAA___ATCTGTACTGCACCCTGGAGGTGGATTCCTTTGGGTATTTTGTGAATAAAGCAAAGACGCGCGTCTACAGGGACACAGCTGAGCCAAACTGGAACGAGG...___GAATTTGAGATAGAGC	in-frame	MGQQPGKVLGDQRRPSLPALHFIKGAGKKESSRHGGPHCNVFVEH|dDESPGLYGFLNVIVHSATGFKQSSNLYCTLEVDSFGYFVNKAKTRVYRDTAEPNWNE	.
BCR	ABL1	+/+	+/+	22:23289621	9:130854067	splice-site	splice-site	translocation	downstream	upstream	0	1	77	386	1134	medium	.	.	duplicates(14),inconsistently_clipped(1)	TATGTCTCCCAGCATGGCCTTCAGGGTGCACAGCCGCAACGGCAAG___AGTTACACGTTCCTGATCTCCTCTGACTATGAGCGTGCAGAGTGGAGGGAGAACATCCGGGAGCAGCAGAAGAAGT___GTTTCAGAAGCTTCTCCCTGACATCCGTGGAGCTGCAGATGCTGACCAACTCGTGTGTGAAACTCCAGACTGTCCACAGCATTCCGCTGACCATCAAcAAGGAAG|CCCTTCAGCGGCCAGTAGCATCTGACTTTGAGCCTCAGGGTCTGAGTGAAGCCGCTCGTTGGAACTCCAAGGAAAACCTTCTCGCTGGACCCAGTGAAAATGACCCCAACCTTTTCGTTGCACTGTATGATTTTGTGGCCAGTGGAGATAACACTCTAAGCATAACTAAAG___GTGAAAAGCTCCGGGTCTTAGGCTATAATCACAATGGGGAATGGTGTGAAGCCCAAACCAAAAATGGCCAAGGCTGGGTCCCAAGCAACTACATCACGCCAGTC	in-frame	MSPSMAFRVHSRNGKSYTFLISSDYERAEWRENIREQQKKCFRSFSLTSVELQMLTNSCVKLQTVHSIPLTINKE|aLQRPVASDFEPQGLSEAARWNSKENLLAGPSENDPNLFVALYDFVASGDNTLSITKGEKLRVLGYNHNGEWCEAQTKNGQGWVPSNYITP	.
ABL1	BCR	+/+	+/+	9:130835525	22:23292541	splice-site	splice-site	translocation	downstream	upstream	0	3	1	27	433	medium	.	.	.	GTTGGAGATCTGCCTGAAGtTGGTGGGCTGCAAATCCAAGAAGGGGCTGTCCTCGTCCTCCAGCTGTTATCTGGAAG|ATCTGTACTGCACCCTGGAGGTGGATTCCTTTGGGTATTTTGTGAATAAAGCAAAGACGCGCGTCTACAGGGACACAGCTGAGCCAAACTGGAACGAG___GAATTTGAGATAGAGCTGGAGGGCTCCCAGACCCTGAGGATACTGTGCTATGAAAAGTGTTACAACAAGACGAAGATCCCCA	in-frame	LEICLKLVGCKSKKGLSSSSSCYLE|dLYCTLEVDSFGYFVNKAKTRVYRDTAEPNWNEEFEIELEGSQTLRILCYEKCYNKTKIP	.
ABL1	BCR	+/+	+/+	9:130714455	22:23309424	splice-site	splice-site	translocation	downstream	upstream	0	1	0	188	197	low	.	.	.	GGAAGAAGGAATCATCGAGGCATGGGGGTCCACACTGCAATGTTTTTGTGGAACATG|CTGGACCCGCAGGCCCTGCAGGACAGAGACTGGCAGCGCACCGTCATCGCCATGAATGGG___ATCGAAGTAAAGCTCTCGGTCAAGTTCAACAGCAGGGAGTTCAGCTTGAAGAGGATGCCGTCCCGAAAACAGAC	out-of-frame	KKESSRHGGPHCNVFVEH|agpagpagqrlaahrhrhewdrskalgqvqqqgvqleedavpkt	.
FP671120.1	NAMPT	+/+	-/-	21:8216803	7:106284907	intron	5'UTR	translocation	downstream	downstream	0	1	18	6	8879	medium	.	.	duplicates(4),mismappers(1)	CCCGGGGAGAGTTCTCTTTTCTTTGTGAAGGGCAGGGCGCCCTGGAATGGGTTCGCCCCGAGAGAGGGGCCCGTGCCTTGtAAAGCGTCGCGGTTCCGGCGGCGTCCGGTGAGCTCTCGCTGGCC...AGGTAAGGGAAGTCGGCAAGCCGGATCCGTAACTTCGGGATAAGGATTGGCTCTAAGGGCTGGGTCGGTCGGGCTGGGGCGCGAAGCG|CGGCCCCTGTCCTCCGGCCCGAGATGAATCCTGCGGCAGAAGCCGAGTTCAACATCCTCCTGGCCACCGACTCCTACAAG___GTTACTCACTATAAACAATATCCACCCAACACAAGCAAAGTTTATTCCTACTTTGAATGCCGTGAAAAGAAGACAG	.	.	.
NAMPT	FP671120.1	-/-	+/+	7:106253077	21:8215509	CDS	intron	translocation	upstream	upstream	1	0	16	65535	81	medium	.	.	duplicates(1)	TTTCTTTATTACAAACGACTATCCTTCAAAACAGGCTAAAGTGTTATGTTTCTGAAAGCCAGATGTGGATTGGTTCAGTTATACCTATTAAGTGCTTAAAACTTAAATGTAAATTATGTATGTGC...AAGGGCCGATTATCTTTACATAGGACG|GCGAAAGACTAATCGAACCATCTAGTAGCTGGTTCCCTCCGAAGTTTCCCTCAGGATAGCTGGCGCTCTCGCAGACCCGACGCACCCCCGCCACGCAGTTTTATCCGGTAAAGCGAATGATTAGAGGTCTTGGGGCCGAAACGATCTCAACCTATTCTCAAACTTTAAATGGGTAAGAAGCCCGGCTCGCTGGCGTGGAGCCGGGCGTGGAATGCGAGTGCCTAGTGGGCCACTTTTGGTAAGCAGAACTGGCGCTGCGGGATGAACCGAACGCCGGGTTAAGGCGCCCGATGCCGACGCTCATCAGACCCCA	out-of-frame	KGRLSLHRT|akd*	.
RUNX1	RUNX1T1	-/-	-/-	21:34859474	8:92017363	splice-site	splice-site	translocation	upstream	downstream	0	9	3	5513	24	medium	.	.	inconsistently_clipped(2)	GTTTGTCGGTCGAAGTGGAAGAG___GGAAAAGCTTCACTCTGACCATCACTGTCTTCACAAACCCACCGCAAGTCGCCACCTACCACAGAGCCATCAAAATCACAGTGGATGGGCCCCGAGAACCTCGAA|ATCGTACTGAGAAGCACTCCACAATGCCAGACTCACCTGTGGATGTGAAGACGCAATCTAGGCTGACTCCTCCAACAATGCCACCTCCCCCAACTACTCAAGGAGCTCCAAGAACCAGTTCATTTACACCGACAACGT___TAACTAATGGCACGAGCCATTCTCCTACAGCCTTGAATGGCGCCCCCTCACCAC	in-frame	FVGRSGRGKSFTLTITVFTNPPQVATYHRAIKITVDGPREPR|nRTEKHSTMPDSPVDVKTQSRLTPPTMPPPPTTQGAPRTSSFTPTTLTNGTSHSPTALNGAPSP	.
RUNX1	RUNX1T1	-/-	-/-	21:34859474	8:92017431	splice-site	splice-site	translocation	upstream	downstream	0	1	3	5513	8	medium	.	.	.	GTTTGTCGGTCGAAGTGGAAGAG___GGAAAAGCTTCACTCTGACCATCACTGTCTTCACAAACCCACCGCAAGTCGCCACCTACCACAGAGCCATCAAAATCACAGTGGATGGGCCCCGAGAACCTCGAA|ATAAACCCCACTTGAAAAACTGAGGTGCTTAAGGAGTAAAATAATATGTTCCTGGTGGCATCCTCCAGATCGTACTGAGAAGCACTCCACAATGCCAGACTCACCTGTGGATGTGAAGACGCAATCTAGGCTGACTCCTCCAACAATGCCACCTCCCCCAACTACTCAAGGAGCTCCAAGAACCAGTTCATTTACACCGACAACGT___TAACTAATGGCACGAGCCATTCTCCTACAGCCTTGAATGGCGCCCCC	out-of-frame	FVGRSGRGKSFTLTITVFTNPPQVATYHRAIKITVDGPREPR|nkphlkn*	.
FP671120.1	IKZF1	+/+	+/+	21:8216497	7:50319060	intron	5'UTR	translocation	downstream	upstream	1	0	6	19	1343	medium	.	.	.	CGCCGCAGGTGCAGATCTTGGTGGTAGTAGCAAATATTCAAACGAGAACTTTGAAGGCCGAAGTGGAGAAGGGTTCCATGTGAACAGCAGTTGAACATGGGTCAGTCGGTCCTGAGAGATGGGCG...GGAGTCGGGTTCAGATCCCCGAATCCGGAGTGGCGGAGATGGGCGCCGCGAGGCGTCCAGTGCGGTAACGCGACCGATCCCGGAGAAGCCGGCGGGAGCCCCGGGGA|CCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAG___GGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGC	.	.	.
FP236383.3	NAMPT	-/+	-/-	21:8438438	7:106276455	exon	exon	translocation/3'-3'	downstream	downstream	0	1	6	59	39414	medium	.	.	.	CTCACCCGGCCCGGACACGGACAGGATTGACAGATTGATAGCTCTTTCTCGATTCCGTGGGTGGTGGTGCATGGCCGTTCTTAGTTGGTGGAGCGATTTGTCTGGTTAATTCCGATAACGAACGAGACTCTGGCATGCTAACTAGTTACGCGACCCCCGAGCGGTCGGCGTCCCCCAACTTCTTAGAGGGACAAGTGGCGTTCAGCCACCCGAGATTGAGCAATAACAGGTCTGTGATGCCCTTAGATGTCCGGGGCTGCACGCGCGCTACACTGACTGGCTCAGCGTGTGCCTACCCTACG|ACTGGAAACTCCTTTTGAATTATGGTAGCAATCAGAATATTTTTATATTAGCCAGTTTTACCTTGAAGACCTATTTTTAAAAACTACCTGTGTCTCTGGACTTAGTTGCAAATGCATATTAAAACAAAAATCCCCCAATTTCTGTGCTTTCTTATTTGAAAGGCCATTTCTAGGGGGAAAACAGTTCCCAAAC	.	.	.
MN1	ETV6	-/-	+/+	22:27796763	12:11826402	splice-site	splice-site	translocation	upstream	upstream	0	3	0	12	2176	medium	.	.	.	CGgTGGCGCCCTGGGAGAAGGCCAAACCCCAGAACCCCAACAGCAAAGAAG|CACAGAATGAAAAGCACCTTTGAAGAATCGTAAGCCATGAATGATGACGGGCCGAAGGGAGTGAGGGCTCCTACCTCTTGTCACTCCTACCATCCTGCCTCCAGGACCCCTGCCACCTACTTGGGAGTCTGCCCTTAAAACTCAAGGGTCACCTGACTCATTCCTCCCCACTCATTCATCTGACTACCCAC	out-of-frame	vAPWEKAKPQNPNSKE|aqnekhl*	.
NACC2	NOTCH1	-/-	-/-	9:136049636	9:136519565	splice-site	splice-site	duplication	upstream	downstream	1	2	0	2	1575	medium	.	.	.	CGACAGCCCCACCTCGTACCACAACGAGGAGGACGAGGAGGACGACGAGGCCTACGACACCATGGTGGAGGAGCAGTACGGCCAGATGTACATCAAGGCCTCCGGCAGCTATGCAG|GCTTCACCGGCCAGAACTGTGAGGAAAATATCGACGATTGTCCAGGAAACAACTGCAAGAACGGGGGTGCCTGTGTGGACGGCGTGAACACCTACAACTGCCGCTGCCCGCCAGAGTGGACAG___GTCAGTACTGTACCGAGGATGTGGACGAGTGCCAGCTGATGC	in-frame	DSPTSYHNEEDEEDDEAYDTMVEEQYGQMYIKASGSYA|gFTGQNCEENIDDCPGNNCKNGGACVDGVNTYNCRCPPEWTGQYCTEDVDECQLM	.
HOOK3	KAT6A	+/+	-/-	8:42897188	8:42049302	splice-site	splice-site	inversion	downstream	downstream	1	1	0	1	5175	medium	.	.	.	GGATCCCCCGACAGAGCGGCGGCGGTGTCTGGCCAGGCGGTAGGCGCTGCCTGGCCGCGGCGGGGAAGATGTTCAGCGTAGAGTCGCTGGAGCGGGCGGAGCTGTGCGAGAGCCTCCTCACTTGG|GCATAAGATGCACATTTTTCTGCTCTGGAGCCGGGAATGAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTGGAAGACATTTCAAaCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGaGTGG	out-of-frame	MFSVESLERAELCESLLTW|a*	.
HOOK3	KAT6A	+/+	-/-	8:42897188	8:42049707	splice-site	splice-site	inversion	downstream	downstream	0	3	0	1	1615	low	.	.	.	GAGCGGCGGCGGTGTCTGGCCAGGCGGTAGGCGCTGCCTGGCCGCGGCGGGGAAGATGTTCAGCGTAGAGTCGCTGGAGCGGGCGGAGCTGTGCGAGAGCCTCCTCACTTGG|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGTCAAGGAAGAGTTGAAATTCCTAGACTG___GCATAAGATGCACATTT...TGAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTGGAAGACATTTCAATCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGGGT	out-of-frame	MFSVESLERAELCESLLTW|dsfy*	.
HOOK3	KAT6A	+/+	-/-	8:42906258	8:42049707	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	1615	low	.	.	.	CCCAGGTTCTTCAAAAGAT|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGTCAAGGAAGAGTTGAAATTCCTAGACTGGTGAGCAGAGATTGCGGAGTACAGAATAGCCATCACCCACTCTG___GCATAAGATGCACATTTTTCTGCTCTGGAGCCGGGAATGAAATATTCTTGAGTTCTTACAACTTTATGACGAG	out-of-frame	QVLQKm|ilstnpdtc*	.
EVI2B	FP671120.1	-/-	+/+	17:31304253	21:8215461	3'UTR	intron	translocation	upstream	upstream	0	0	17	45697	94	low	.	.	duplicates(3)	CAATTGTATCTCCTCTTCCAAATGATTCTACTAGTCTCCCTCCATCTCTGGACTGTCTCAATCAAGACTGTGGAGATCATAAATCTGAGATAATACAATCATTTCCACCGCTTGACTCACTTAACTTGCCCCTGCCACCAGTAGATTTTATGAAAAACCAAGAAGATTCCAACCTTGAGATCCAGTGTCAGGAGTTCTCTATTCCTCCCAACTCTGATCAAGATCTTAATGAATCCCTGCCACCTCCACCTGCAGAACTGTTATAAATATTACAAC...|...CCGTAGCGGTCCTGACGTGCAAATCGGTCGTCCGACCTGGGTATAGGGGCGAAAGACTAATCGAACCATCTAGTAGCTGGTTCCCTCCGAAGTTTCCCTCAGGATAGCTGGCGCTCTCGCAGACCCGACGCACCCCCGCCACGCAGTTTTATCCGGTAAAGCGAATGATTAGAGGTCTTGGGGCCGAAACGATCTCAACCTATTCTCAAACTTTAAATGGGTAAGAAGCCCGGCTCGCTGGCGTGGAGCCGGGCGTGGAATGCGAGTGCCTAGTGGGCCACTTTTGGTAAGCAGAACTGGCGCTGCGGGATGAACCGAACGCCGG	.	.	.
PICALM	NAMPT	-/-	-/-	11:85958469	7:106275454	3'UTR	exon	translocation	upstream	downstream	0	0	9	5535	65535	low	.	.	.	TATCAAGAAAAGCCCTTATgTGGAAAGTGTGAAATTTGTATTTGGAAAAGCTGCCTGGAGAGAAGAACTGTGTCCTTTAaTGTATTTCAACAGGACTCTTTTGGGG...CACAAATACAGAAACAATAACTGAAATTAACTTTTCTTTTTTTAAAAAAAcTTATATTCAGTTTGCAGTAGACATTtCTTAAGTATTTGTATTTATTTATGATTATCAATTTTACATAACATTAA...|...GGAAATTACTGACTTACCAACCCTAAAGATGCCACATTCTTTACGAACGAAGTGAGACGTTTCATTTGGATGTAAGAAGCTTTTGAGTCATCTCAAAGTTGAAAAGTACCAAAATTAATCGAGAG...AAGTTAATATCATTTTTAAAAGCTGTGCAAGTAATAATTTTTTCTATTACACATCTGCTTTTACAATAAATAAACATTTATACTTTGAGTTATTAAAAGTACAAATTCCTTTTCTGACTCTGCTG	.	.	.
NAMPT	PICALM	-/-	-/-	7:106250498	11:86031505	3'UTR	CDS	translocation	upstream	downstream	0	0	7	46180	13362	low	.	.	.	AGAAAATACTTGAAAATAAATTACATTGCCTTTTGTCCATTAATCAGCAAATAAAACATGGCCTTAACAAAGTTGTTTGTGTTATTGTACAATTTGAAAATTATGTCGGGcCATACCCTATAGAA...|...CATTACAACTCATCATTTGATGGTGTATGGAAATGAG___CGTTTTATTCAaTATTTGGCTTCAAGAAACACGTTGTTTAACTTAAGCAATTTTTTGGATAAAAGTGGATTGCAAG___GATATGACATGTCTACATTTATTAGGC	.	.	.
EVI2B	NAMPT	-/-	-/-	17:31304449	7:106284844	CDS	CDS	translocation	upstream	downstream	0	0	9	65535	24459	low	.	.	mismappers(2)	CTTAGAAATTAAGTTGTTTGAATCAAGTGAAAACATTGAAGACTCCAACAACCCCAAAACAGAGAAAATAAAAGATCAAGTAAATGGTACATCAGAAGATAGTGCTGATGGTTCAACAGTTGGAA...GAAGGACAGGAAAGTAACCAATCTGACAAACCCACAATGACAATTGTATCTCCTCTTCCAAATGATTCTACTAGTCTCCCTCCATCTCTGGACTGTCTCAATCAAGACTGTGGAGATCAT...|...CCACCGACTCCTACAAG___GTTACTCACTATAAACAATATCCACCCAACACAAGCAAAGTTTATTCCTACTTTGAATGCCGTGAAAAGAAGACAGAAAACTCCAAATTAAGGAAGGTGAAATATGAG	.	.	.
FP671120.1	EP300	+/+	+/+	21:8215554	22:41131426	intron	CDS	translocation	downstream	upstream	0	0	7	81	4997	low	.	.	.	CCGAGGGCGCACCACCGGCCCGTCTCGCCCGCCGCGCCGGGGAGGTGGAGCACGAGCGCACGTGTTAGGACCCGAAAGATGGTGAACTATGCCTGGGCAGGGCGAAGCCAGAGGAAACTCTGGTGGAGGTCaGTAGCGGTCCTGACGTGCAAATCGGTCGTCCGACCTGGGTATAGGGGCGAAAGACTAATCGAACCATCTAGTAGCTGGTTCCCTCCGAAGTT...|...AGCTCTCTAGGGGTGGGTCAACAGTCTGCCCCCAACCTAAGCACTGTTAGTCAGATTGATCCCAGCTCCATAGAAAGAGCCTATGCAGCTCTTGGACTACCCTATCAAGTAAATCAGATGCCGAC	.	.	.
NAMPT	MSI2	-/-	+/+	7:106249653	17:57264377	3'UTR	exon	translocation	upstream	upstream	0	0	7	17396	39	low	.	.	mismappers(1)	AACTATAGCCCAAAGGCCAAATgTGGACTTCTTTTTATAAATGCAGATTGTCTATGGCTGCTTTCCtACTACTCCAGCCTAAGGTAAACAGCTGCAATAaAAGCCAAATGAGAATC...|...TTTATTTATTTATTTATTTTTGAGATGGGATCTCACTGTGTTGCCCAGGCTGGTCgTAAACTCCTGGGCCAAGCTATCCTCCCACCTCTGCCCCCCAGAGTGCTGGGATTATAGGCGTGAGCCAC	.	.	.
NAMPT	YPEL5	-/-	+/+	7:106250346	2:30158935	3'UTR	3'UTR	translocation	upstream	upstream	0	0	7	30632	14164	low	.	.	.	TAATCATTCTACATTAAAGAAAATAATGGTTCTTACTGGAATGTCTAGGCACTGTACAGTTATTATATATCTTGGTTGTTGTATTGTACCAGTGAAATGCCAAATTTGAAAGGCCTGT...|...ATTAATGAACTGCGGAACAAGAGGTTGTGAGAATCTAAGATGGAACCTTTCTTTCTTTCTTTCTTTTTTTTTAAATTTTGTATTTTCCATCCAACAGCAGTGTGTAGAGAGAATATTATGCAGA...TGTTTACATCTTGAGGCAtCAtAGTCTGTCTGCAGCTATGTGGTGAGCTATGTAAGGAAAAAAATCTGGGCTGTTAGAGTGAAAAAGTGTGTTTTATGTCAATTGTGAAAGGAAAATGTTAGGAG	.	.	.
NAMPT	RNF213	-/-	+/+	7:106248751	17:80339245	3'UTR	CDS	translocation	upstream	upstream	0	0	7	8923	1567	low	.	.	.	GATTAATTCTGACTTTCTGaCACTAAGCACTTGGTATTTGGCCATCTCCATTCTGAGCACCAAACGGTTAACACGAATGTCCACTAGAACTCTGaTGTGTGgCACCCTTAAATCAGTCTAAATCT...|...GCcCTCTGCTGGGgATATGgTGTTCAGGACGTGGATCGCCATGGCCTACTGCTCCCCCAAGCAGGGTGTGTCCCTCCAAATGGACTTTGGCTTGGACCTGGTGACGGAGCTTAAAGAAGGTGGAG	.	.	.
NAMPT	CDK6	-/-	-/-	7:106250497	7:92614642	3'UTR	3'UTR	deletion	upstream	downstream	0	0	7	46180	905	low	.	.	.	AAAATACTTGAAAATAAATTACATTGCCTTTTGTCCATTAATCAGCAAATAAAACATGGCCTTAACAAAGaTGTTTGTGTTATTGTACAATTTGAAAATTATGTCGGGACATACCCTATAGAAT...|...AATTCAATTTTAAAGACTCAAGGTGGTCAGTAAATAACAGGCATTTGTTCACTGAAGGTGATTCACCAAAATAGTCTTCTCAAATTAGAAAGTTAACCCCATGTCCTCAGCATTTCTTTTCTGGC	.	.	.
EP300	RNF213	+/+	+/+	22:41178663	17:80313125	CDS	CDS	translocation	downstream	upstream	0	0	6	6229	2426	low	.	.	.	CCCCATGAGaCCCCAGCAGCATATGCTCCCAAATCAGaCCCAGTCCCCACACCTACAAGGaCAGCAGATCCCTAATTCTCTCTCCAATCAAGTGCGCTCTCCCCAGCCTGTCCCTTCTCCACGGC...|...CACATCTTCAGGTGCCTCATTCACATACGTCAAGGAAATTGAG___GTCTGGAGGCGGCTGGTGGAAATCCAATTCCCCGCGGAGCATGGCTGGAAGGAGTCGTTGCTGGGAGACATGGAATGGAaGC	.	.	.
CREBBP	FP671120.4	-/-	-/+	16:3726895	21:8254637	3'UTR	exon	translocation/5'-5'	upstream	upstream	0	0	6	8953	53	low	.	.	.	AAAAAATAGGGATGATCACTCTTAGACCATGCTAATGTTACTAGAGAAGAAGCCTTCTTTTCTTTCTTCTATGTGAAACTTGAAATGAGGAAAAGCAATTCTAGTGTAAATCATGCAAGCGCTCTAATTCCTATAAATACGAAACTCGAGAAGATTC...|...TTTACTTTGAAAAAATTAGAGTGTTCAAAGCAGGCCCGAGCCGCCTGGATACCGCAGCTAGGAATAATGGAATAGGcCCGCGGTTCTATTTTGTTGGTTTTCGGAACTGAGGCCATGATTAAGAG	.	.	.
CSF3R	FP671120.4	-/-	-/+	1:36466050	21:8254626	3'UTR	exon	translocation/5'-5'	upstream	upstream	0	0	6	563	53	low	.	.	.	CTTTAAGGACCAGATCATGCTCCATCCAGCCCCACCCAATGGCCTTTTGTGCTTGTTTCCTATAACTTCAGTATTGTAAACTAGTTTTTGGTTTGCAGTTTTTGTTGTTGTTTATAGACACTCTT...|...GGCCCGAAGCGTTTACTTTGAAAAAATTAGAGTGTTCAAAGCAGGCCCGAGCCGCCTGGATACCGCAGCTAGGAATAATGGAATAGGACCGCGGTTCTATTTTGTTGGTTTTCGGAACTGAGGCCATGATTAAGAGGGACGGCCGGGGGCATTCGTATTGCGCCGCTAGAGGTGAAATTCTTGGACCGGCGCAAGACGGACCAGAGCGAAAGCATTTGCCAAGAATGTTTTCATTAATCAAGAAC	.	.	.
FP671120.1	KAT6A	+/+	-/-	21:8216699	8:42048929	intron	CDS	translocation	downstream	downstream	0	0	6	31	6417	low	.	.	.	CGTCCAGTGCGGTAACGCGACCGATCCCGGAGAAGCCGGCGGGAGCCCCGGGGAGAGTTCTCTTTTCTTTGTGAAGGGCAGGGCGCCCTGGAATGGGTTCGCCCCGAGAGAGGGGCCCGTGCCTT...CGTCGCGGTTCCGGCGGCGTCCGGTGAGCTCTCGCTGGCCCTTGAAAATCCGGGGGAGAGGGTGTAAATCTCGCGCCGGGCCGTACCCATATCCGCAGCAGGTCTCCAAGGTGAACAGCaTCTGG...|...ATCAAAAAAGTGAAAAAGCAGAAACAGCGTCCTTCAGAAGAAAGGATATGCAATGCTGTGTCTTCATCCCATGGCTTGGATCGTAAAACTGTTTTAGAACAATTGGAGTTGAGTGTTAAAGATGG...TCAATTCCTATAAAGATCCTGATAATCCTGGGCGAATAGCACTTCCTAAGCCTCGGAACCATGGAAAATTGGATAATAAACAAAATGTGGATTGGAATAAACTGATAAAGCGGGCAGTTGAGGG	.	.	.
SF3B1	FP671120.1	-/-	+/+	2:197396201	21:8215662	CDS	intron	translocation	upstream	upstream	0	0	6	11510	85	low	.	.	duplicates(3)	CTCTTAAAAGCCCACAAAAAGGCTATTCGTAGAGCCACAGTCAACACATTTGGTTATATTGCAAAGtaCATTGG___CCCTCATGATGTATTGGCTACACTTCTGAACAACCTCAAAGTTCAAGAAAGGCAGAACgGAGTTTGTACCACTGTAGCAATAGCTATTGTTGCAGAAACATGTTCACCCTTTACAGTACTaCCTGCCT...|...ATTCTCAAACTTTAAATGGGTAAGAAGCCCGGCTCGCTGGCGTGGAGCCGGGCGTGGAATGCGAGTGCCTAGTGGGCCACTTTTGGTAAGCAGAACTGGCGCTGCGGGATGAACCGAACGCCGGG...GGCCATGGAAGTCGGAATCCGCTAAGGAGTGTGTAACAACTCACCTGCCGAATCAACTAGCCCTGAAAATGGATGGCGCTGGAGCGTCGGGCCCATACCCGGCCGTCGCCGGCAGTCGAGAGTGG	.	.	.
FP236383.1	RNF213	+/+	+/+	21:8399276	17:80298346	intron	CDS	translocation	downstream	upstream	0	0	5	19	1834	low	.	.	.	CCCGCGGACGCTACGCCGCGACGAGTAGGAGGGCCGCTGCGGTGAGCCTTGAAGCCTAGGGCGCGGGCCCGGGTGGAGCCGCCGCAGGTGCAGATCTcGGTGGTAGTcGCA...|...TGCCAAAGATGCATGGACACAAGGACGTACACCTGGCTGGGCGCCCTGCCTGTCCTGCACTGCTGTATGGAGCTGGCCCCGCGGCACAAGGATGCCTGGAGACAGCCTGAGGACACCTGGGCCGC	.	.	.
ZMYM2	CDK6	+/+	-/-	13:20086011	7:92612665	CDS	3'UTR	translocation	downstream	downstream	0	0	3	2391	487	low	.	.	.	TCTACAGATAGCCCTGTCTGGTATACGTCTACTTCACTGGACCGAAACACCTTGGAAAATATGCTTGTACGGGTTCTTCTAGTAAAAGATATTTATGATAAAGACAATTATGAACTGGATGAAGACACAGAC...|...GGCAGTGCTTATGAAGAAAAATTAAAGCACAAACATTCTGGCATTCAATCGTTGGCAGATTATCTTCTGATGACACAGAATGAAAGGGCATCTCAGCCTCTCTGAACTTTGTAAAAATCTGTCCC	.	.	.
PCM1	TRIP11	+/+	-/-	8:17957355	14:92005718	CDS	CDS	translocation	downstream	downstream	0	0	3	2629	2952	low	.	.	.	TTCTGAGCATGAAAATTCCGAGCCTGTTACTAACATTCG___AAATCCACAAGTAGCTTCCACTTGGAATGAAGTAAATAGTCATAGTAATGCACAGTGTGTTTCTAATAATAGAGATGGGCGAACAGTTAATT...|...ATACCTCTaCCTTACAGCTGGAACATGAGCATTTAATTAAACTCAATCAAAAGAAAGACATGGAAATAGCAGAACTCAAAAAGAATATTGAACAAATGGATACTGACCATAAAGAAACTAAGGAC	.	.	.
KDM5A	CDK6	-/-	-/-	12:292955	7:92614582	CDS	3'UTR	translocation	upstream	downstream	0	0	3	6245	1298	low	.	.	.	CTTTTTGGAGAAGGAAAACAGAAGTCCAAGGAGTTAAAGAAAATGGACAAACCTAGAAAGAAGAAATTAAAATTAGGTGCAGACAAATCAAAGGAGCTGAATAAACTGGCCAAGAAACTAGaAAA...|...ATTCACCAAAATAGTCTTCTCAAATTAGAAAGTTAACCCCATGTCCTCAGCATTTCTTTTCTGGCCAAAAGCAGTAAATTTGCTAGCAGTAAAAGATGAAGTTTTATACACACAGCAAAAAGGAG	.	.	.
NAMPT	NUP98	-/-	-/-	7:106261588	11:3713995	splice-site	splice-site	translocation	upstream	downstream	1	0	2	51206	3553	low	.	.	mismappers(1)	CACAGGCACCACTAATAATCAGACCTGATTCTGGAAACCCTCTTGACACTGTGTTAAAG___GTTTTGGAGATTTTAGGTAAGAAGTTTCCTGTTACTGAGAACTCAAAGGGTTACAAGTTGCTGCCACCTTATCTTAGAGTTATTCAAGGGGATGGAGTAGATATTAATACCTTACAAGAG|GAAGGCTGAAGTTACATTGGATGGAGTTTGGCCAACAGATAAAACATCTCGTTGTTTAATAAAGAGCC	out-of-frame	QAPLIIRPDSGNPLDTVLKVLEILGKKFPVTENSKGYKLLPPYLRVIQGDGVDINTLQE|eg*	.
TTL	MSI2	+/+	+/+	2:112529260	17:57257517	3'UTR	CDS	translocation	downstream	upstream	0	0	2	252	1126	low	.	.	.	CTGCTCTGGACTATGGATTGGACGTCAGAGCATATTGGAGGTTGCCTGTGTGTTCCCCACCCcTCCCTTCGGTAACACTCTGCCACACTAAGCTCTGT...|...TCATGAGAGATCCCACTACGAAACGCTCCAG___AGGCTTCGGTTTCGTCACGTTCGCAGACCCAGCAAGTGTAGATAAAGTATTAGGTCAGCCCCACCATGAGTTAGATTCCAAGACG___ATTGACCCC	.	.	.
LYN	KAT6A	+/+	-/-	8:55999549	8:42049707	splice-site	splice-site	inversion	downstream	downstream	0	1	1	0	1615	low	.	.	.	CCTATGGGAAAATTCCCTACCCAG|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGTCAAGGAAGAGTTGAAATTCCTAGACTGGTGAGCAG...AAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTGGAAGACATTTCAATCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGGG	out-of-frame	YGKIPYP|gfflliqilvevltsflgkdvkeelkfldw*	.
IKBKB	KAT6A	+/+	-/-	8:42272205	8:42049707	splice-site	splice-site	inversion	downstream	downstream	0	2	0	0	1615	low	.	.	.	GCTGGTCACCTTCCCTGACAACGCAGACATGTGGGGCCTGGGAAATGAAAGAGCGCCTTGGGACAGGGGGATTTGGAAATGTCATCCGATGGCACAATCAG|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGTCA...GAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTGGAAGACATTTCAATCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGGGTGGCATTCTGTTTTGTGAAAGGAG	out-of-frame	MSSDGTIr|ilstnpdtc*	.
NAMPT	IKZF1	-/-	+/+	7:106284828	7:50319048	splice-site	splice-site	inversion	upstream	upstream	0	1	1	16050	1343	low	.	.	.	CGCAGCCGCGCCAGGGAGCTCGCGGCGCGCGGCCCCTGTaCTCCGGCCCGAGATGAATCCgGCGGCAGAAGCCGAGTTCAACATCCTCCTGGCCACCGACTCCTACAAG|ATAACCTGAGGACCATGGATGCTGATGAGGGTCAAGACATGTCCCAAGTTTCAG___GGAAGGAAAGCCCCCCTGTAAGCGATACTCCAGATGAGGGCGA...CCACCACCTCGGGAGGACAGCAAAGCTCCAAGAGTGACAGAGTCGTGG___CCAGTAATGTTAAAGTAGAGACTCAGAGTGATGAAGAGAATGGGCGTGCCTGTGAAATGAATGGGGAAGAATGgGCG	out-of-frame	MNPAAEAEFNILLATDSYK|it*	.
WNK1	ERC1	+/+	+/+	12:830160	12:1408149	splice-site	splice-site	deletion	downstream	upstream	0	1	0	0	1095	low	.	.	.	CCGTCGCGTGACCAGT|ACGCAAAATCGAATGAAGCTAATGGCCGACAACTACGAGGATGACCACTTCAAATCCTCCCATTCCAATCAAACAAATCACAAGCCCTCCCCAGACCAG	in-frame	RRVTS|TQNRMKLMADNYEDDHFKSSHSNQTNHKPSPD	.
WNK1	ERC1	+/+	+/+	12:754324	12:1027750	splice-site	splice-site	deletion/read-through	downstream	upstream	1	0	0	1	1074	low	.	.	.	GCGAGAAGTGGCAGCGGCGGCGGCAGCGCCAAGGAGCCACAGGAGGAACGGAGCCAGCAGCAGGATGATATCGAAGAGCTGGAGACCAAGGCCGTGGGAATGTCTAACGATGGCCGCTTTCTCAA...CTGAAACCACCGTGGAAGTCGCCTGGTGTGAACTGCAG|ATGGTGTAAGATACTTCTTCAAGATTGGACAGCTGGGGACCTTCTTCTGATTAACCTTAAACCAACTTGTAGCCATAGAGACACC	out-of-frame	ETTVEVAWCELQ|mv*	.
STAU2	KAT6A	-/-	-/-	8:73746783	8:42049302	splice-site	splice-site	deletion	upstream	downstream	0	1	0	0	5175	low	.	.	.	GTTTGCCAATGTTGGAGCCGTCTGCAAAGTGTCCCCGGCAAGAAG|GCATAAGATGCACATTTTTCTGCTCTGGAGCCGGGAATGAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGgGAAATTCATTGGGAAGTTGGAAGACATTTCAAaCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGGGTG	.	.	.
STAU2	KAT6A	-/-	-/-	8:73746783	8:42049707	splice-site	splice-site	deletion	upstream	downstream	0	1	0	0	1615	low	.	.	.	GCCGTCTGCAAAGTGTCCCCGGCAAGAAG|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGTCAAGGAAGAGTTGAAATTCCTAGACTGGTGAGCAGAGATTGCGGAGTACAGAATAGCC	.	.	.
NUP98	NSD1	-/-	+/+	11:3744509	5:177235821	splice-site	splice-site	translocation	upstream	upstream	1	0	0	851	982	low	.	.	.	CCTGTTTGGCAATAACAAGCTTACTACATTTGGAAGCAGCACAACCAGTGCACCTTCATTTGGTACAACCAGTGGCGGGCTCTTTG___GTTTTGGCACAAATACCAGTGGGAATAGTATTTTTGGAA...TTGGGGCCCCTGGATTTAATACTACGgCAGCCAgTTTGGGCTTTGGAGCCCCCCAGGCCCCAGTAG|CTGTGCGGTCAGAGAAGAAACGCCTTAGGAAGCCAAGCAAGTGGCTTTTGGAATATAC	in-frame	GAPGFNTTaAsLGFGAPQAPV|aVRSEKKRLRKPSKWLLEY	.
JAK2	RFX3	+/+	-/-	9:5126446	9:3293258	splice-site	splice-site	inversion	downstream	downstream	0	1	0	2449	1	low	.	.	.	ATTTGATAGAACTTTTGAAGAATAATGGAAGATTACCAAGACCAGATGGATGCCCAGATGAG|CTCCAGTGGCTGTTGGACAATTATGAGACAGCAGAAGGAGTGAGCCTTCCCAGAAGCACTCTGTACAACCACTACCTTCGACACTGTCAGGAACACAAACTGGACCCAGTCAATGCTGCCTCTTTTGGAAAATTAATAAGATCAATTTTTATGGGGCTACGAACCAGGAGATTGGGCA	in-frame	LIELLKNNGRLPRPDGCPDE|LQWLLDNYETAEGVSLPRSTLYNHYLRHCQEHKLDPVNAASFGKLIRSIFMGLRTRRLG	.
NCOA2	KAT6A	-/-	-/-	8:70296744	8:42049302	splice-site	splice-site	deletion	upstream	downstream	0	1	0	1087	5175	low	.	.	.	TATAGATCTTCTGCACTGTTTACAGGCACAG|GCATAAGATGCACATTTTTCTGCTCTGGAGCCGGGAATGAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTaGAAGACATTTCAAaCAACAGGT	.	.	.
NCOA2	KAT6A	-/-	-/-	8:70403700	8:42049707	splice-site	splice-site	deletion	upstream	downstream	0	1	0	701	1615	low	.	.	.	GCTTCGGCGGCGAAGGTCAGCGCCGACGGCAGCCGGCACCTGACGGCGTGACCGACCCGAGCCG|GATTCTTTCTACTAATCCAGATACTTGTTGAAGTGCTGACTAGTTTCTTGGGGAAAGATGT...GAAATATTCTTGAGTTCTTACAACTTTATGACGAGACCCATGTGTGGTGCTATTGAGAAATTCATTGGGAAGTTGGAAGACATTTCAAaCAACAGGTTGTTTTGGTTTCTATAGTACAATTGGGG	.	.	.
LINC00921	CREBBP	+/+	-/-	16:3263883	16:3851009	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	4923	low	.	.	.	AGCCACGAAGTGGTGGGAAATACGAGATTCAAATATCTGGTGGCCGTGTGAC|ATTTTGGATCATTGTTTGACTTGGAAAATGATCTTCCTGATGAGCTGATACCCAATGGAGGAGAATTAGGCCTTTTAAACAGTGGGAACCTTGTTCCAGATGCTGCTTCCAAACATAAACAACTGTCGGAGC	.	.	.
LINC00921	CREBBP	+/+	-/-	16:3263883	16:3731937	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	10946	low	.	.	.	ACGAGATTCAAATATCTGGTGGCCGTGTGAC|GGCAGTCAGGGCGACAGCAAGAATGCCAAGAAGAAGAACAACAAGAAAACCAACAAGAACAAAAGCAGCATCAGCCGCGCCAACAAGAAGAAGCCCAGCATGCCCAACGTGTCCAATGACCTGTCCCAGAAGCTGTATGCCACCATGGAGAAGCACAAGGAG___GTCTTCTTCGTGATCCACCTGCACGCTGGGCCTGTCATCAACACCCTGCC	.	.	.
ZNF263	CREBBP	+/+	-/-	16:3263883	16:3731937	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	10946	low	.	.	.	ACGAGATTCAAATATCTGGTGGCCGTGTGAC|GGCAGTCAGGGCGACAGCAAGAATGCCAAGAAGAAGAACAACAAGAAAACCAACAAGAACAAAAGCAGCATCAGCCGCGCCAACAAGAAGAAGCCCAGCATGCCCAACGTGTCCAATGACCTGTCCCAGAAGCTGTATGCCACCATGGAGAAGCACAAGGAG___GTCTTCTTCGTGATCCACCTGCACGCTGGGCCTGTCATCAACACCCTGCC	.	.	.
ZNF263	CREBBP	+/+	-/-	16:3263883	16:3851009	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	4923	low	.	.	.	AGCCACGAAGTGGTGGGAAATACGAGATTCAAATATCTGGTGGCCGTGTGAC|ATTTTGGATCATTGTTTGACTTGGAAAATGATCTTCCTGATGAGCTGATACCCAATGGAGGAGAATTAGGCCTTTTAAACAGTGGGAACCTTGTTCCAGATGCTGCTTCCAAACATAAACAACTGTCGGAGC	.	.	.
CREBBP	CORO7-PAM16	-/-	-/-	16:3736036	16:4365545	splice-site	splice-site	duplication	upstream	downstream	1	0	0	9417	0	low	.	.	.	TACAAAAAGATGCTGGtCAAGGCGTTTGCAGAGCGGATCATCCATGACTACAAG___GATATTTTCAAACAAGCAACTGAAGACAGGCTCACCAGTGCCAAGGAACTGCCCTATTTTGAAGGTGATTT...GAAGAGAGCACTGCAGCCAGTGAAACCACTGAG|GTGTCTCGTGCCTCTGCTGGACCCTGACTCTGGGCTCCTGGTCCTGGCAGGAAAGGTGAGTGAGAAGCTGGGGCTCCCACCCACATCCACA	out-of-frame	EESTAASETTE|vsrasagp*	.
CREBBP	CORO7-PAM16	-/-	-/-	16:3767720	16:4405567	splice-site	splice-site	duplication	upstream	downstream	0	1	0	10192	1	low	.	.	.	AAGAAACCTGAAGTGAAAGTAGAAGTTAAAGAGGAAGAAGAGAGTAGCAGTAACGGCACAGCCTCTCAGTCAACATCTCCTTCGCAGCCGCGCAAAAAAA|AGCTGGCAGCCCATGGGGACCTGGTGCAGAGCGCCGTCTGGAGCCGAGATGGAGCCCTGGTGGGCACGGCGTGCAAG___GACAAGCAGCTGCaGATCTTTGACCCCAGAACAAAGCCGCGGGCC	in-frame	KKPEVKVEVKEEEESSSNGTASQSTSPSQPRKK|kLAAHGDLVQSAVWSRDGALVGTACKDKQLqIFDPRTKPR	.
CREBBP	CORO7	-/-	-/-	16:3736036	16:4365545	splice-site	splice-site	duplication	upstream	downstream	1	0	0	9417	0	low	.	.	.	TACAAAAAGATGCTGGtCAAGGCGTTTGCAGAGCGGATCATCCATGACTACAAG___GATATTTTCAAACAAGCAACTGAAGACAGGCTCACCAGTGCCAAGGAACTGCCCTATTTTGAAGGTGATTT...GAAGAGAGCACTGCAGCCAGTGAAACCACTGAG|GTGTCTCGTGCCTCTGCTGGACCCTGACTCTGGGCTCCTGGTCCTGGCAGGAAAGGTGAGTGAGAAGCTGGGGCTCCCACCCACATCCACA	out-of-frame	EESTAASETTE|vsrasagp*	.
CREBBP	CORO7	-/-	-/-	16:3767720	16:4405567	splice-site	splice-site	duplication	upstream	downstream	0	1	0	10192	1	low	.	.	.	AAGAAACCTGAAGTGAAAGTAGAAGTTAAAGAGGAAGAAGAGAGTAGCAGTAACGGCACAGCCTCTCAGTCAACATCTCCTTCGCAGCCGCGCAAAAAAA|AGCTGGCAGCCCATGGGGACCTGGTGCAGAGCGCCGTCTGGAGCCGAGATGGAGCCCTGGTGGGCACGGCGTGCAAG___GACAAGCAGCTGCaGATCTTTGACCCCAGAACAAAGCCGCGGGCC	in-frame	KKPEVKVEVKEEEESSSNGTASQSTSPSQPRKK|kLAAHGDLVQSAVWSRDGALVGTACKDKQLqIFDPRTKPR	.
PRKCB	CREBBP	+/+	-/-	16:23837406	16:3851009	splice-site	splice-site	inversion	downstream	downstream	0	1	0	0	4923	low	.	.	.	GGGGCTTCGGGAAGCAGGGATTCCAGTGCCAAG|ATTTTGGATCATTGTTTGACTTGGAAAATGATCTTCCTGATGAGCTGATACCCAATGGAGGAGAATTAGGCCTTTTAAACAGTGGGAACCTTGTTCCAGATGCTGCTTCCAAACATAAACAACTGTCGGAGC	.	.	.
CREBBP	AC005520.1	-/-	+/+	16:3736036	14:73892027	splice-site	splice-site	translocation	upstream	upstream	1	0	0	9417	0	low	.	.	.	ATTTTCAAACAAGCAACTGAAGACAGGCTCACCAGTGCCAAGGAACTGCCCTATTTTGAAGGTGATTTCTGGCCCAATGTGTTAGAAGAGAGCATTAAGGAACTAGAACAAGAAGAAGAGGAGAGGAAAAAGGAAGAGAGCACTGCAGCCAGTGAAACCACTGAG|GTTACATTGATTACCCACCTAGTACAACATCTTACGGGAAG	out-of-frame	IFKQATEDRLTSAKELPYFEGDFWPNVLEESIKELEQEEEERKKEESTAASETTE|vtlithlvqhltg	.
CREBBP	ZNF410	-/-	+/+	16:3736036	14:73892027	splice-site	splice-site	translocation	upstream	upstream	1	0	0	9417	0	low	.	.	.	ATTTTCAAACAAGCAACTGAAGACAGGCTCACCAGTGCCAAGGAACTGCCCTATTTTGAAGGTGATTTCTGGCCCAATGTGTTAGAAGAGAGCATTAAGGAACTAGAACAAGAAGAAGAGGAGAGGAAAAAGGAAGAGAGCACTGCAGCCAGTGAAACCACTGAG|GTTACATTGATTACCCACCTAGTACAACATCTTACGGGAAG	out-of-frame	IFKQATEDRLTSAKELPYFEGDFWPNVLEESIKELEQEEEERKKEESTAASETTE|vtlithlvqhltg	.
BCL6	EIF4A2	-/-	+/+	3:187736090	3:186785883	splice-site	splice-site	inversion	upstream	upstream	0	1	0	3265	4526	low	.	.	.	CACTAACCTTGGAGCCGATGGGATTGAGTGACTGGCACTTGGGACCACAGAGAAATGTCAGAGTGTTTGGTTACAGACTCAAGGAAACCTCTCATTTTAGAGTGCTCATTTG|ATCCAAAAGGTAATTCTGGCACTTGGAGACTATATGGGAGCCACTTGTCATGCCTGCATTGGTGGAACAAATGTTCGAAATGAAATGCAAAAACTGCAGGCTGAAGCACCACATATTGTTGTTGGTACACCCGGG	.	.	.
NAMPT	MCM3AP	-/-	-/-	7:106284828	21:46285394	splice-site	splice-site	translocation	upstream	downstream	0	1	0	16050	920	low	.	.	.	CTGCGGCAGAAGCCGAGTTCAACATCCTCCTGGCCACCGACTCCTACAAG|CTTGTTCTAAAGACGAAGGGGAACTCCCTAGTGCTACAGGCTGTTTCAGGAAGCCAATTAATTTTGTACACATAATACTTAATTACCTTCTAATAATTGGAGCAGAAGATGAACCCAACTAATCCTTTCAGTGGGCAGCAGCCTAGTGCTTTTTCGGCGTCTTCTAGTAATGTAGGAACACTTCCATCTAAGCCGCC	out-of-frame	AAEAEFNILLATDSYK|lvlktkgnslvlqavsgsqlilyt*	."""
        with open(self.tmp_in_tsv, "w") as writer:
            writer.write(content)

    def tearDown(self):
        # Clean temporary files
        for curr_file in [self.tmp_in_tsv, self.tmp_out_tsv]:
            if os.path.exists(curr_file):
                os.remove(curr_file)

    def test_ReadWrite(self):
        # Read, convert to VCF, convert to dict and write
        with ArribaIO(self.tmp_out_tsv, "w") as writer:
            with ArribaIO(self.tmp_in_tsv) as reader:
                for first_bnd, second_bnd in reader:
                    writer.write((first_bnd, second_bnd))
        # Eval
        expected = None
        with open(self.tmp_out_tsv) as expec_reader:
            expected = expec_reader.readlines()
        observed = None
        with open(self.tmp_out_tsv) as obs_reader:
            observed = obs_reader.readlines()
        self.assertEqual(expected, observed)


class UtilsTest(unittest.TestCase):
    def test_getCoordDictFromCoordStr(self):
        # Ok
        data = [
            {
                "input": "chr1:10:+",
                "expected": {
                    "chrom": "chr1",
                    "pos": 10,
                    "strand": "+"
                }
            },
            {
                "input": "1:222526778:-",
                "expected": {
                    "chrom": "1",
                    "pos": 222526778,
                    "strand": "-"
                }
            }
        ]
        expected = []
        observed = []
        for curr in data:
            expected.append(curr["expected"])
            observed.append(getCoordDictFromCoordStr(curr["input"]))
        self.assertEqual(expected, observed)
        # Invalid field
        with self.assertRaises(Exception) as context:
            getCoordDictFromCoordStr("chr1:a:+")
        with self.assertRaises(Exception) as context:
            getCoordDictFromCoordStr("chr1:20:a")

    def test_getAltFromCoord(self):
        data = [
            # First shard is + and second is -
            {
                "first_coord": {
                    "chrom": "chr2",
                    "pos": 321681,
                    "strand": "+"
                },
                "second_coord": {
                    "chrom": "chr17",
                    "pos": 198982,
                    "strand": "-"
                },
                "expected": ("N]chr17:198982]", "N]chr2:321681]")
            },
            # First shard is + and second is +
            {
                "first_coord": {
                    "chrom": "chr13",
                    "pos": 123456,
                    "strand": "+"
                },
                "second_coord": {
                    "chrom": "chr2",
                    "pos": 321682,
                    "strand": "+"
                },
                "expected": ("N[chr2:321682[", "]chr13:123456]N")
            },
            # First shard is - and second is -
            {
                "first_coord": {
                    "chrom": "chr9",
                    "pos": 88969186,
                    "strand": "-"
                },
                "second_coord": {
                    "chrom": "chr9",
                    "pos": 102784508,
                    "strand": "-"
                },
                "expected": ("]chr9:102784508]N", "N[chr9:88969186[")
            },
            # First shard is - and second is +
            {
                "first_coord": {
                    "chrom": "chr13",
                    "pos": 123457,
                    "strand": "-"
                },
                "second_coord": {
                    "chrom": "chr17",
                    "pos": 198983,
                    "strand": "+"
                },
                "expected": ("[chr17:198983[N", "[chr13:123457[N")
            }
        ]
        expected = []
        observed = []
        for curr in data:
            expected.append(curr["expected"])
            observed.append(getAltFromCoord(curr["first_coord"], curr["second_coord"]))
        self.assertEqual(expected, observed)

    def test_getCoordStr(self):
        data = [
            # First shard is + and second is -
            {
                "in": VCFRecord(
                    region="chr2",
                    position=321681,
                    knownSNPId="1",
                    refAllele="N",  # ref
                    altAlleles=["N]chr17:198982]"],  # alt
                    info={"RNA_FIRST": True, "MATEID": "2"}
                ),
                "expected": {
                    "chrom": "chr2",
                    "pos": 321681,
                    "strand": "+"
                },
            },
            {
                "in": VCFRecord(
                    region="chr17",
                    position=198982,
                    knownSNPId="1",
                    refAllele="N",  # ref
                    altAlleles=["N]chr2:321681]"],  # alt
                    info={"MATEID": "1"}
                ),
                "expected": {
                    "chrom": "chr17",
                    "pos": 198982,
                    "strand": "-"
                }
            },
            # First shard is + and second is +
            {
                "in": VCFRecord(
                    region="chr13",
                    position=123456,
                    knownSNPId="3",
                    refAllele="N",  # ref
                    altAlleles=["N[chr2:321682["],  # alt
                    info={"RNA_FIRST": True, "MATEID": "4"}
                ),
                "expected": {
                    "chrom": "chr13",
                    "pos": 123456,
                    "strand": "+"
                }
            },
            {
                "in": VCFRecord(
                    region="chr2",
                    position=321682,
                    knownSNPId="4",
                    refAllele="N",  # ref
                    altAlleles=["]chr13:123456]N"],  # alt
                    info={"MATEID": "3"}
                ),
                "expected": {
                    "chrom": "chr2",
                    "pos": 321682,
                    "strand": "+"
                }
            },
            # First shard is - and second is -
            {
                "in": VCFRecord(
                    region="chr9",
                    position=88969186,
                    knownSNPId="5",
                    refAllele="N",  # ref
                    altAlleles=["]chr9:102784508]N"],  # alt
                    info={"RNA_FIRST": True, "MATEID": "6"}
                ),
                "expected": {
                    "chrom": "chr9",
                    "pos": 88969186,
                    "strand": "-"
                }
            },
            {
                "in": VCFRecord(
                    region="chr9",
                    position=102784508,
                    knownSNPId="6",
                    refAllele="N",  # ref
                    altAlleles=["N[chr9:88969186["],  # alt
                    info={"MATEID": "5"}
                ),
                "expected": {
                    "chrom": "chr9",
                    "pos": 102784508,
                    "strand": "-"
                }
            },
            # First shard is - and second is +
            {
                "in": VCFRecord(
                    region="chr13",
                    position=123457,
                    knownSNPId="7",
                    refAllele="N",  # ref
                    altAlleles=["[chr17:198983[N"],  # alt
                    info={"RNA_FIRST": True, "MATEID": "8"}
                ),
                "expected": {
                    "chrom": "chr13",
                    "pos": 123457,
                    "strand": "-"
                }
            },
            {
                "in": VCFRecord(
                    region="chr17",
                    position=198983,
                    knownSNPId="8",
                    refAllele="N",  # ref
                    altAlleles=["[chr13:123457[N"],  # alt
                    info={"MATEID": "7"}
                ),
                "expected": {
                    "chrom": "chr17",
                    "pos": 198983,
                    "strand": "+"
                }
            }
        ]
        expected = []
        observed = []
        for curr in data:
            expected.append(curr["expected"])
            observed.append(getCoordStr(curr["in"]))
        self.assertEqual(expected, observed)


#####################################################################
#
# MAIN
#
#####################################################################
if __name__ == '__main__' :
    unittest.main()
